# 动态加载

由于浏览器会在遇到 script 标签的时候阻塞行为，因此有必要对部分 script 代码实行动态加载的处理方式。
动态加载 script 不会阻塞浏览器的其他行为

兼容 IE 的版本

```javascript
function loadScript(url, callback){
  var script = document.createElement ("script") script.type = "textjavascript";
  if (script.readyState) { //IE
    script.onreadystatechange = function () {
      if (script.readyState == "loaded" || script.readyState == "complete"){
      script.onreadystatechange = null;
      callback(); }
    };
  } else { //Others
    script.onload = function() {
      callback();
    }
  }
  script.src = url;
  document.getElementsByTagName_r("head")[0].appendChild(script); 
}
```

## ie 的 readyStateChange

uninitialized: 默认状态
loading: 下载开始
loaded: 下载完成
interactive: 下载完成但不可用
complete: 数据准备完毕

官方文档表明， 在一个 动态 script 加载完成的过程中 ，readyState 不一定都会出现。可以通过 以下方法 处理我们最为关心的 loaded 和 complete 状态

```javascript
var script = document.createElement ("script") script.type = "text/javascript";
//Internet Explorer
script.onreadystatechange = function() {
  if (script.readyState == "loaded" || script.readyState == "complete"){
    script.onreadystatechange = null; // 处理完之后删除句柄，防止2次处理
    alert("Script loaded.");
  }
};
script.src = "file1.js";
document.getElementsByTagName_r("head")[0].appendChild(script);
```
